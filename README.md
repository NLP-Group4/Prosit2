# Interius: Agentic API Generator

Interius is a platform that allows non-developers to build highly capable, production-ready REST APIs simply by describing what they want in plain English. 

It leverages an **Agentic Pipeline** powered by Large Language Models to fully automate the software development lifecycle: from gathering requirements to writing FastAPI code, reviewing it for security, testing it, and deploying it live.

## Architecture

Interius is built with a modern stack:
- **Frontend**: React + Vite (vanilla CSS, Framer Motion)
- **Backend**: FastAPI (Python) + SQLModel
- **Database**: PostgreSQL (backend) + Supabase (frontend threads/messages)
- **Vector Store**: ChromaDB (Embedded) for generated code RAG
- **LLM Engine**: Provider-agnostic via OpenAI-compatible API. Uses OpenRouter to seamlessly switch between models (e.g., Qwen for coding, DeepSeek for reviewing, Gemini for embeddings).
- **Execution Engine**: Dockerized Sandbox sidecar for zero-config live deployments and automated testing.

### The Agentic Pipeline
When a user submits a prompt, the FastAPI Orchestrator coordinates six specialized AI agents using a Server-Sent Events (SSE) stream to provide real-time frontend feedback:

1. **Requirements Agent**: Analyzes the prompt (and any document context) to generate a structured `ProjectCharter` (entities, endpoints, business rules).
2. **Architecture Agent**: Takes the charter and designs the `SystemArchitecture`, including Pydantic/SQLModel specs and a Mermaid ER diagram.
3. **Implementer Agent**: Writes the executable Python codebase (`GeneratedCode`) based on the architecture.
4. **Test Runner**: Runs deterministic checks (syntax validation, import smoke tests) and auto-patches any failures.
5. **Test Generator Agent**: Uses an LLM to generate a `pytest` suite tailored to the architecture's endpoints.
6. **Reviewer Agent (with Loop)**: Reviews the code for bugs and security vulnerabilities. If issues are found or the trust score is below threshold (≥7/10), the orchestrator routes the code back (up to 5 passes) in a "Perceive-Plan-Act" cycle until the Reviewer approves it.

### Sandbox Execution
After the review loop, the orchestrator automatically deploys the generated code and tests into a safe `sandbox-runner` Docker container. The sandbox:
- Installs dependencies, starts `uvicorn`, waits for health check
- Runs the generated `pytest` suite natively via `start.sh`
- Reports pass/fail results back to the orchestrator
- On failure, parses tracebacks and auto-patches the code (up to 3 retries)

Users can also manually deploy via the **Open Sandbox** button in the frontend to get a live Swagger UI.

### Dynamic API Tester
The frontend's built-in **API Tester** panel dynamically renders endpoint cards based on the actual `ProjectCharter` endpoints generated by the pipeline — no hardcoded routes.

## Running the Demo

The easiest way to see Interius in action is using Docker Compose.

1. **Set your API Keys**
   Copy the `.env.example` to `.env` (if not already done) and configure your database and LLM provider credentials:
   ```bash
   LLM_BASE_URL="https://openrouter.ai/api/v1"
   LLM_API_KEY="your-api-key-here"
   MODEL_IMPLEMENTER="google/gemini-2.5-pro"
   MODEL_REVIEWER="anthropic/claude-3.5-sonnet"
   ```

2. **Start the Environment**
   ```bash
   docker compose up --build
   ```
   This will launch the frontend, backend, PostgreSQL database, Adminer, and the Sandbox Runner.

3. **Access the Application**
   - **Frontend Dashboard**: Open [http://localhost:5173](http://localhost:5173) (requires registration/login to reach the `/generate` view).
   - **Backend API Docs**: [http://localhost:8000/docs](http://localhost:8000/docs)
   - **Sandbox API Docs**: Automatically spins up on [http://localhost:9000/docs](http://localhost:9000/docs) upon deployment.

4. **Try Generation**
   - Upload a text or PDF document in the **Document Upload** panel to populate the RAG context.
   - Go to the **Generate API** chat panel and type a prompt (e.g., *"Build me a bookstore API"*).
   - Watch the pipeline execute in real-time, view the generated artifacts, and test your new API live within the sandbox!

## Development

If you prefer to run the components separately for active development:

**Backend:**
```bash
cd backend
uv sync
uv run fastapi run app/main.py --reload
```

**Frontend:**
```bash
cd frontend
npm install
npm run dev
```

## Documentation

Detailed architecture docs are in `docs/`:
- [System Architecture](docs/architecture-system.md)
- [Agent Pipeline Flow](docs/architecture-pipeline.md)
- [Database Schema](docs/architecture-database.md)
- [RAG Pipeline](docs/architecture-rag.md)
